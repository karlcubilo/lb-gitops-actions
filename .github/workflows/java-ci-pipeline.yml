name: Java CI Workflow
on:
  workflow_call:
    secrets:
      SONAR_TOKEN:
        description: Sonar Cloud Token
    inputs:
      application-name:
        required: true
        type: string
        description: Application Name
      package-options:
        required: true
        type: string
        default: mvn clean package
        description: Build, Test and Package
      run-sonar:
        required: false
        type: string
        description: Run Sonar Analysis
      java-version:
        required: true
        type: string
        description: Java Version
     
jobs:
  maven-build:
    runs-on: ubuntu-latest
    steps: 
    -  name: Maven Build
       uses: karlcubilo/lb-gitops-actions/java-maven-build@latest
       with:
         package-options: ${{inputs.package-options}}
         java-version: ${{inputs.java-version}}
  sonar-analysis: 
    needs: [maven-build]
    if: ${{inputs.run-sonar == 'true' }} 
    runs-on: ubuntu-latest
    steps:
    -  name: Sonar Analysis
       uses: karlcubilo/lb-gitops-actions/java-sonar-analysis@latest
       with:
         sonar-options: ${{inputs.sonar-options}}
        

     
